# Chapter 03. 테스트 코드 작성 순서

### 01. 테스트 코드 작성 순서
- 테스트 코드는 아무렇게나 작성하는 것이 아닌, 일정한 기준에 따라 작성해야 합니다. 
- 그렇지 않으면 테스트에 많은 시간이 소요되거나 코드가 지저분해져 처음부터 다시 시작해야 하는 일이 발생할 수 있습니다.

### 02. 테스트 코드 작성 순서 기준
- 이러한 경우를 우선적으로 테스트해야 합니다.   
(1) **구현하기 쉬운 테스트** → **구현하기 어려운 테스트**   
(2) **예외적인 경우** → **정상적인 경우**

### 03. 초반에 복잡한 테스트를 피하는 이유
- 복잡한 테스트를 초반에 추가하면, 해당 테스트를 통과시키기 위해 많은 코드를 한 번에 구현해야 합니다. 
- 예를 들어 암호 강도 측정 기능을 구현할 때, 대문자 포함 규칙만 충족하는 경우를 먼저 테스트하는 것이 좋습니다.

```java
@Test
void meetsOnlyUpperCriteria_Then_Weak() {
    PasswordStrengthMeter meter = new PasswordStrengthMeter();
    PasswordStrength result = meter.meter("abcDef");
    assertEquals(PasswordStrength.WEAK, result);
}
```

- 간단한 구현으로 테스트를 통과시킬 수 있습니다.

```java
public class PasswordStrengthMeter {
    public PasswordStrength meter(String s) {
        return PasswordStrength.WEAK;
    }
}
```

### 04. 예외적인 경우를 먼저 테스트하는 이유
- 예외 상황을 미리 테스트하면, 복잡한 if-else 구조를 미리 작성하게 되어 코드의 구조를 단순하게 유지할 수 있습니다. 
- 예외 상황을 고려하지 않으면 코드가 복잡해지고 버그 발생 가능성이 높아집니다.

### 05. 구현하기 쉬운 테스트부터 시작하기
- 구현하기 쉬운 테스트를 먼저 수행하면 빠르게 테스트를 통과시킬 수 있습니다. 
- 예를 들어 암호 강도 측정 기능에서 가장 쉬운 테스트는 모든 조건을 충족하는 경우입니다.

```java
@Test
void meetsAllCriteria_Then_Strong() {
    PasswordStrengthMeter meter = new PasswordStrengthMeter();
    PasswordStrength result = meter.meter("abcDef12");
    assertEquals(PasswordStrength.STRONG, result);
}
```

### 06. 완급 조절
- 가벼운 리팩토링(변수명 변경, 상수 관리 등)은 테스트 코드 작성 중에도 진행할 수 있지만, 로직을 변경하는 리팩토링은 테스트 코드 작성이 마무리된 후에 진행하는 것이 좋습니다.

### 07. 테스트할 목록 미리 정해두기
- TDD를 시작할 때, 테스트할 목록을 미리 작성해두면 순서를 생각하기 쉽고, 예외 상황에 대해서도 미리 고려할 수 있습니다. 
- 테스트 목록을 작성하면 기억력에 의존하지 않고 체계적으로 테스트를 진행할 수 있습니다.

### 07. 테스트를 한 번에 다 작성하지 말자
- 한 번에 많은 테스트를 작성하면 리팩토링에 대한 심리적 저항이 생기고, 개발 리듬을 유지하기 어렵습니다. 
- 하나의 테스트를 만들고 통과시키는 과정을 반복하면서 개발하는 것이 좋습니다.

### 08. 변경 범위가 큰 리팩토링
- 변경 범위가 큰 리팩토링은 TDD 흐름을 깨기 쉬우므로, 먼저 테스트를 통과시키고 나중에 리팩토링을 진행합니다. 
- 큰 리팩토링을 수행하기 전에 코드를 커밋하여 형상관리 시스템에 보관합니다.

### 09. 시작이 안 될 때는 단언부터 고민하자
- 테스트 코드 작성이 막힐 때는 검증 코드를 먼저 작성해보면 도움이 됩니다.

```java
@Test
void 만원_납부하면_한달_뒤가_만료일이_됨() {
    assertEquals(LocalDate.of(2019, 8, 9), 실제만료일);
}
```

- 이후 필요한 값을 하나씩 채워나가면서 테스트 코드를 완성합니다.

### 10. 진행이 막히면 
- TDD를 진행하다가 막힐 때는 과감하게 코드를 지우고 다시 시작합니다. 쉬운 테스트와 예외적인 테스트를 우선적으로 작성하며, 테스트 순서 목록을 참고하여 피드백을 받아가며 진행합니다.

---
### # 생각해보기
#### Q 01. TDD를 적용하기 전에 개발자가 고민해야 하는 주요 사항은 무엇인가요?
- **기능 분석**: 개발할 기능을 분석하고 명확하게 이해해야 합니다. 어떤 입력이 주어졌을 때 기능이 어떻게 동작해야 하는지를 파악해야 합니다.
- **테스트 사항 정의**: 각각의 기능에 대한 테스트 사항을 정의해야 합니다. 어떤 조건에서 어떤 결과를 기대하는지를 명확하게 정리해야 합니다.
- **설계 고려**: 기능을 구현하기 전에 클래스와 메서드의 구조를 고민해야 합니다. 어떤 클래스와 인터페이스가 필요하며, 각각의 메서드는 어떤 기능을 수행해야 하는지를 고려해야 합니다.

#### Q 02. 다음과 같은 상황에서 제일 먼저 진행해야할 테스트는 무엇일까요?
(1) 정상적인 납부후의 만료일 계산 테스트   
(2) 결제수단의 변경 테스트   
(3) 세금 계산 테스트   
(4) 연속 납부 할인율 테스트   

- 정답 : 정상적인 납부후의 만료일 계산 테스트
